
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Slick Database Programming in Scala - Giocode labs</title>
  <meta name="author" content="Rindra Ramamonjison">

  
  <meta name="description" content="Awesome are Scala Collections.
Working with Scala collections is simply a joy and apparently effortless! Their interfaces are rich, consistent and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://giocode.github.io/blog/2015/06/02/functional-database-programming-with-slick">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Giocode labs" type="application/atom+xml">
  <script src="//use.typekit.net/qja5dag.js"></script>
  <script>try{Typekit.load();}catch(e){}</script>
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Giocode labs</a></h1>
  
    <h2>A playground for code, data and models</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
  
  
  
  
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:giocode.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/projects/index.html">Projects</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Slick Database Programming in Scala</h1>
      
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-02T19:38:49-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>7:38 pm</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://giocode.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2 id="awesome-are-scala-collections">Awesome are Scala Collections.</h2>
<p>Working with Scala collections is simply a joy and apparently effortless! Their interfaces are rich, consistent and nicely separated from implementation. Yet, we have many to choose from and each collection offers different characteristics in terms of performance, mutability and laziness. <img class="right" src="../images/slick.png" width="260" height="260" />Chances are you will find the right tool for the job. In addition, Scala collections work great with for-comprehensions. With Scala, not only do we have power but also we have a flexibility to express our computations: either in a Map-Reduce-Filter pattern or simply using a for expression. With Scala collections, we can always get rid of boilerplate and understand performance. </p>

<h3 id="so-is-slick">So is Slick!</h3>
<p>With the Slick library, database programming would also enjoy such simplicity. Slick is a cool library that enable to query and access relational databases in plain Scala. Slick enables us to treat database tables almost as if they were Scala collections. In addition, it also gives us full control over when a database access happens and which data is transferred. In addition to its functional relational mapping features, Slick queries are type safe expressions. In other words, the compiler can catch inconsistencies at compile-time. Furthermore, we can compose simple queries into more complex ones and we can do so before even running them against the database. Apart from that, Slick also simplifies database managementt asks from creating schema and data models to managing connections and query transactions.</p>

<p>In this tutorial, I will highlight Slick’s functional features and use the database of a Wine restaurant as an illustrative example. </p>

<!-- more -->

<h2 id="getting-started-with-slick">Getting Started with Slick</h2>

<p>Programming a Slick database application consists of the following steps: </p>

<ol>
  <li>Configuring the database driver dependencies in SBT. </li>
  <li>Defining the database schema.</li>
  <li>Creating Slick queries</li>
  <li>Connecting to the database </li>
  <li>Run the queries or CRUD operations</li>
</ol>

<p>Let’s go through these steps in detail.</p>

<h3 id="configuring-build-dependencies">Configuring Build Dependencies</h3>

<p>We start by creating an SBT Scala project and configure the build settings in build.sbt:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="scala"><span class="line"><span class="n">name</span> <span class="o">:=</span> <span class="s">&quot;wine-slick-example&quot;</span>
</span><span class="line">
</span><span class="line"><span class="n">version</span> <span class="o">:=</span> <span class="s">&quot;1.0&quot;</span>
</span><span class="line">
</span><span class="line"><span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">&quot;2.11.6&quot;</span>
</span><span class="line">
</span><span class="line"><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;org.scala-lang&quot;</span> <span class="o">%</span> <span class="s">&quot;scala-compiler&quot;</span> <span class="o">%</span> <span class="n">scalaVersion</span><span class="o">.</span><span class="n">value</span>
</span><span class="line">
</span><span class="line"><span class="n">libraryDependencies</span> <span class="o">++=</span> <span class="nc">List</span><span class="o">(</span>
</span><span class="line">  <span class="s">&quot;com.typesafe.slick&quot;</span> <span class="o">%%</span> <span class="s">&quot;slick&quot;</span>           <span class="o">%</span> <span class="s">&quot;2.1.0&quot;</span><span class="o">,</span>
</span><span class="line">  <span class="s">&quot;com.h2database&quot;</span>      <span class="o">%</span> <span class="s">&quot;h2&quot;</span>              <span class="o">%</span> <span class="s">&quot;1.3.0&quot;</span><span class="o">,</span>
</span><span class="line">  <span class="s">&quot;ch.qos.logback&quot;</span>      <span class="o">%</span> <span class="s">&quot;logback-classic&quot;</span> <span class="o">%</span> <span class="s">&quot;1.1.2&quot;</span>
</span><span class="line"><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This file declares the library dependencies that a Slick project at least needs: the Slick library, the database driver library and a logging library. Here, we have chosen H2 database for simplicity. If you were to use MySQL or PostgreSQL, then the H2 dependency should be replaced by the corresponding JDBC driver. </p>

<p>Once the SBT configurations are set, we can build our Slick application and start by importing the H2 Library: </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="scala"><span class="line"><span class="k">import</span> <span class="nn">scala.slick.driver.H2Driver</span>
</span><span class="line"><span class="k">import</span> <span class="nn">scala.slick.driver.H2Driver.simple._</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>These help Slick to understand the functions provided by the database-specific driver (e.g. H2 driver here). It is convenient to import everything from <code>H2Driver.simple</code> to make sure all required implicit conversions and extension methods are in place when Slick needs them.</p>

<h3 id="defining-the-schema">Defining the Schema</h3>

<p>After these simple configurations, we need define the database table and the type of each row in the table. In our example, we will only define one table of wines. Therefore, let’s create a case class <code>Wine</code> and define its properties: </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="scala"><span class="line"><span class="c1">// Message type </span>
</span><span class="line"><span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Wine</span><span class="o">(</span><span class="n">color</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">maker</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">year</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span>
</span><span class="line">					  <span class="n">country</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">price</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">id</span><span class="k">:</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">0L</span><span class="o">){</span>
</span><span class="line">    <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="n">f</span><span class="s">&quot;$name $year ($country ~ $color)&quot;</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Next, let’s define the table <code>WineTable</code>:  </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="scala"><span class="line"><span class="c1">// Define a Table[Wine]</span>
</span><span class="line"><span class="k">final</span> <span class="k">class</span> <span class="nc">WineTable</span><span class="o">(</span><span class="n">tag</span><span class="k">:</span> <span class="kt">Tag</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Table</span><span class="o">[</span><span class="kt">Wine</span><span class="o">](</span><span class="n">tag</span><span class="o">,</span> <span class="s">&quot;wine&quot;</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">    <span class="k">def</span> <span class="n">id</span> <span class="k">=</span> <span class="n">column</span><span class="o">[</span><span class="kt">Long</span><span class="o">](</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">O</span><span class="o">.</span><span class="nc">PrimaryKey</span><span class="o">,</span> <span class="n">O</span><span class="o">.</span><span class="nc">AutoInc</span><span class="o">)</span>
</span><span class="line">    <span class="k">def</span> <span class="n">color</span> <span class="k">=</span> <span class="n">column</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;color&quot;</span><span class="o">)</span>
</span><span class="line">    <span class="k">def</span> <span class="n">maker</span> <span class="k">=</span> <span class="n">column</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;maker&quot;</span><span class="o">)</span>
</span><span class="line">    <span class="k">def</span> <span class="n">name</span> <span class="k">=</span> <span class="n">column</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;name&quot;</span><span class="o">)</span>
</span><span class="line">    <span class="k">def</span> <span class="n">year</span> <span class="k">=</span> <span class="n">column</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="s">&quot;year&quot;</span><span class="o">)</span>
</span><span class="line">    <span class="k">def</span> <span class="n">country</span> <span class="k">=</span> <span class="n">column</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;country&quot;</span><span class="o">)</span>
</span><span class="line">    <span class="k">def</span> <span class="n">price</span> <span class="k">=</span> <span class="n">column</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="s">&quot;price&quot;</span><span class="o">)</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="o">*</span> <span class="k">=</span> <span class="o">(</span><span class="n">color</span><span class="o">,</span> <span class="n">maker</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">year</span><span class="o">,</span> <span class="n">country</span><span class="o">,</span> <span class="n">price</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span> <span class="o">&lt;&gt;</span> <span class="o">(</span><span class="nc">Wine</span><span class="o">.</span><span class="n">tupled</span><span class="o">,</span> <span class="nc">Wine</span><span class="o">.</span><span class="n">unapply</span><span class="o">)</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>In the above code, we tell Slick three important things: </p>

<ul>
  <li>First, we tell Slick to define a table of wine by extending the abstract class <code>Table</code> with the type parameter <code>Wine</code>. By convention (since Slick 2.0), we also need to pass an extra tag argument with the table name. Note that the tag is however automatically passed by Slick and we do not need to specify it. </li>
  <li>Second, we specify the type, name and any constraint for each column in the table by defining a get method for each property of <code>Wine</code>. For example, we add the constraint for <code>id</code> to be an auto-incrementing primary key.</li>
  <li>Finally, the projecion operator <code>*</code> is defined to map each row in <code>WineTable</code> to the Scala class <code>Wine</code> using <code>Wine</code>’s default <code>tupled</code> and <code>unapply</code> method.</li>
</ul>

<h3 id="creating-queries">Creating queries</h3>

<h2 id="more-about-crud-operations">More about CRUD operations</h2>

<h3 id="creating-tables">Creating tables</h3>

<h3 id="select-statement">Select statement</h3>

<h3 id="inserting-rows">Inserting rows</h3>

<h3 id="updating-rows">Updating rows</h3>

<h3 id="deleting-rows">Deleting rows</h3>

<h2 id="joins-and-aggregates">Joins and Aggregates</h2>

<h2 id="reactive-streams-in-slick-30">Reactive Streams in Slick 3.0</h2>
</div>


  <footer>
    <p class="meta">
      
  



  <span class="byline author vcard">Authored by <span class="fn">
  
    Rindra Ramamonjison
  
  </span></span>


      




<time class='entry-date' datetime='2015-06-02T19:38:49-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>7:38 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://giocode.github.io/blog/2015/06/02/functional-database-programming-with-slick/" data-via="" data-counturl="http://giocode.github.io/blog/2015/06/02/functional-database-programming-with-slick/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/10/16/functional-playground-solving-rush-hour-game-in-haskell/" title="Previous Post: Functional playground: solving the Rush Hour game in Haskell">&laquo; Functional playground: solving the Rush Hour game in Haskell</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Rindra Ramamonjison 
<!--   -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span> &#8211;>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = '';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://giocode.github.io/blog/2015/06/02/functional-database-programming-with-slick/';
        var disqus_url = 'http://giocode.github.io/blog/2015/06/02/functional-database-programming-with-slick/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>










  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
